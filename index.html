<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Editor & Validasi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/theme/monokai.min.css">
  <style>
    body {
      background: #121212;
      color: white;
      font-family: sans-serif;
      padding: 20px;
    }
    .CodeMirror {
      height: auto;
      min-height: 300px;
      background: #1e1e1e;
      color: white;
      font-size: 14px;
    }
    #errorDisplay {
      margin-top: 10px;
      font-weight: bold;
    }
    .btn-group {
      margin-top: 15px;
    }
    button {
      margin-right: 10px;
      padding: 8px 14px;
      background: #333;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #555;
    }
    video {
      margin-top: 20px;
      width: 100%;
      max-width: 600px;
      border: 2px solid #00ff88;
      border-radius: 10px;
    }
    #hiddenClipboard {
      position: absolute;
      left: -9999px;
      top: -9999px;
    }
  </style>
</head>
<body>
  <h2>üìù Ketik Teks - Validasi Otomatis</h2>
  <textarea id="editorArea"></textarea>
  <div id="errorDisplay">Menunggu input...</div>

  <div class="btn-group">
    <button onclick="copyToClipboard()">üìã Copy Teks</button>
    <button onclick="saveToFile()">üíæ Simpan</button>
    <button onclick="playVideo()">‚ñ∂Ô∏è Putar Video Hiburan</button>
  </div>

  <textarea id="hiddenClipboard"></textarea> <!-- Hidden copy backup -->

  <video id="videoPlayer" controls hidden>
    <source src="https://files.catbox.moe/2cb5kn.mp4" type="video/mp4">
    Browser tidak mendukung video.
  </video>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/mode/javascript/javascript.min.js"></script>
  <script>
    const editor = CodeMirror.fromTextArea(document.getElementById("editorArea"), {
      lineNumbers: true,
      mode: "javascript",
      theme: "monokai",
      lineWrapping: true
    });

    const errorDisplay = document.getElementById("errorDisplay");

    editor.on("change", () => {
      const code = editor.getValue();
      try {
        new Function(code); // Validasi JS
        localStorage.setItem("validTeksAuto", code);
        errorDisplay.textContent = "‚úÖ Kode Valid & Disimpan Otomatis";
        errorDisplay.style.color = "#00ff88";
      } catch (e) {
        errorDisplay.textContent = "‚ùå Error: " + e.message;
        errorDisplay.style.color = "red";
      }
    });

    function copyToClipboard() {
      const code = editor.getValue();
      if (!code.trim()) {
        alert("Tidak ada teks untuk disalin.");
        return;
      }

      // Coba pakai Clipboard API modern
      navigator.clipboard.writeText(code).then(() => {
        alert("‚úÖ Teks berhasil disalin!");
      }).catch(() => {
        // Fallback jika gagal (misal di browser Android)
        const temp = document.getElementById("hiddenClipboard");
        temp.value = code;
        temp.select();
        document.execCommand("copy");
        alert("‚úÖ Teks berhasil disalin! (fallback)");
      });
    }

    function saveToFile() {
      const code = editor.getValue();
      const blob = new Blob([code], { type: "text/plain" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "kode_valid.js";
      a.click();
    }

    function playVideo() {
      const video = document.getElementById("videoPlayer");
      video.hidden = false;
      video.play();
      window.scrollTo({ top: video.offsetTop, behavior: 'smooth' });
    }
  </script>
</body>
</html>